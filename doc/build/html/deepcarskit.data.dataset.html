

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>deepcarskit.data.dataset package &mdash; DeepCARSKit 1.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> DeepCARSKit
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
    
            
            
              
            
            
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">deepcarskit.data.dataset package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-deepcarskit.data.dataset.dataset">deepcarskit.data.dataset.dataset module</a><ul>
<li><a class="reference internal" href="#deepcarskit-data-dataset">deepcarskit.data.dataset</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-deepcarskit.data.dataset">Module contents</a></li>
</ul>
</li>
</ul>
</div>
            
          
    <a href="py-modindex.html">Module Index</a>
  
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">DeepCARSKit</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>deepcarskit.data.dataset package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/deepcarskit.data.dataset.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="deepcarskit-data-dataset-package">
<h1>deepcarskit.data.dataset package<a class="headerlink" href="#deepcarskit-data-dataset-package" title="Permalink to this headline">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</section>
<section id="module-deepcarskit.data.dataset.dataset">
<span id="deepcarskit-data-dataset-dataset-module"></span><h2>deepcarskit.data.dataset.dataset module<a class="headerlink" href="#module-deepcarskit.data.dataset.dataset" title="Permalink to this headline">¶</a></h2>
<section id="deepcarskit-data-dataset">
<h3>deepcarskit.data.dataset<a class="headerlink" href="#deepcarskit-data-dataset" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="deepcarskit.data.dataset.dataset.Dataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepcarskit.data.dataset.dataset.</span></span><span class="sig-name descname"><span class="pre">Dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepcarskit.data.dataset.dataset.Dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p><a class="reference internal" href="#deepcarskit.data.dataset.dataset.Dataset" title="deepcarskit.data.dataset.dataset.Dataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code></a> stores the original dataset in memory.
It provides many useful functions for data preprocessing, such as k-core data filtering and missing value
imputation. Features are stored as <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> inside <a class="reference internal" href="#deepcarskit.data.dataset.dataset.Dataset" title="deepcarskit.data.dataset.dataset.Dataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code></a>.
General and Context-aware Models can use this class.</p>
<p>By calling method <a class="reference internal" href="#deepcarskit.data.dataset.dataset.Dataset.build" title="deepcarskit.data.dataset.dataset.Dataset.build"><code class="xref py py-meth docutils literal notranslate"><span class="pre">build()</span></code></a>, it will processing dataset into
DataLoaders, according to <code class="xref py py-class docutils literal notranslate"><span class="pre">EvalSetting</span></code>.</p>
<dl>
<dt>Args:</dt><dd><p>config (Config): Global configuration object.</p>
</dd>
<dt>Attributes:</dt><dd><p>dataset_name (str): Name of this dataset.</p>
<p>dataset_path (str): Local file path of this dataset.</p>
<p>field2type (dict): Dict mapping feature name (str) to its type (<code class="xref py py-class docutils literal notranslate"><span class="pre">FeatureType</span></code>).</p>
<dl class="simple">
<dt>field2source (dict): Dict mapping feature name (str) to its source</dt><dd><p>(<code class="xref py py-class docutils literal notranslate"><span class="pre">FeatureSource</span></code>).
Specially, if feature is loaded from Arg <code class="docutils literal notranslate"><span class="pre">additional_feat_suffix</span></code>, its source has type str,
which is the suffix of its local file (also the suffix written in Arg <code class="docutils literal notranslate"><span class="pre">additional_feat_suffix</span></code>).</p>
</dd>
<dt>field2id_token (dict): Dict mapping feature name (str) to a <code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code>, which stores the original token</dt><dd><p>of this feature. For example, if <code class="docutils literal notranslate"><span class="pre">test</span></code> is token-like feature, <code class="docutils literal notranslate"><span class="pre">token_a</span></code> is remapped to 1, <code class="docutils literal notranslate"><span class="pre">token_b</span></code>
is remapped to 2. Then <code class="docutils literal notranslate"><span class="pre">field2id_token['test']</span> <span class="pre">=</span> <span class="pre">['[PAD]',</span> <span class="pre">'token_a',</span> <span class="pre">'token_b']</span></code>. (Note that 0 is
always PADDING for token-like features.)</p>
</dd>
<dt>field2token_id (dict): Dict mapping feature name (str) to a dict, which stores the token remap table</dt><dd><p>of this feature. For example, if <code class="docutils literal notranslate"><span class="pre">test</span></code> is token-like feature, <code class="docutils literal notranslate"><span class="pre">token_a</span></code> is remapped to 1, <code class="docutils literal notranslate"><span class="pre">token_b</span></code>
is remapped to 2. Then <code class="docutils literal notranslate"><span class="pre">field2token_id['test']</span> <span class="pre">=</span> <span class="pre">{'[PAD]':</span> <span class="pre">0,</span> <span class="pre">'token_a':</span> <span class="pre">1,</span> <span class="pre">'token_b':</span> <span class="pre">2}</span></code>.
(Note that 0 is always PADDING for token-like features.)</p>
</dd>
<dt>field2seqlen (dict): Dict mapping feature name (str) to its sequence length (int).</dt><dd><p>For sequence features, their length can be either set in config,
or set to the max sequence length of this feature.
For token and float features, their length is 1.</p>
</dd>
</dl>
<p>uid_field (str or None): The same as <code class="docutils literal notranslate"><span class="pre">config['USER_ID_FIELD']</span></code>.</p>
<p>iid_field (str or None): The same as <code class="docutils literal notranslate"><span class="pre">config['ITEM_ID_FIELD']</span></code>.</p>
<p>label_field (str or None): The same as <code class="docutils literal notranslate"><span class="pre">config['LABEL_FIELD']</span></code>.</p>
<p>time_field (str or None): The same as <code class="docutils literal notranslate"><span class="pre">config['TIME_FIELD']</span></code>.</p>
<dl class="simple">
<dt>inter_feat (<code class="xref py py-class docutils literal notranslate"><span class="pre">Interaction</span></code>): Internal data structure stores the interaction features.</dt><dd><p>It’s loaded from file <code class="docutils literal notranslate"><span class="pre">.inter</span></code>.</p>
</dd>
<dt>user_feat (<code class="xref py py-class docutils literal notranslate"><span class="pre">Interaction</span></code> or None): Internal data structure stores the user features.</dt><dd><p>It’s loaded from file <code class="docutils literal notranslate"><span class="pre">.user</span></code> if existed.</p>
</dd>
<dt>item_feat (<code class="xref py py-class docutils literal notranslate"><span class="pre">Interaction</span></code> or None): Internal data structure stores the item features.</dt><dd><p>It’s loaded from file <code class="docutils literal notranslate"><span class="pre">.item</span></code> if existed.</p>
</dd>
</dl>
<p>feat_name_list (list): A list contains all the features’ name (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>), including additional features.</p>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="deepcarskit.data.dataset.dataset.Dataset.avg_actions_of_items">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">avg_actions_of_items</span></span><a class="headerlink" href="#deepcarskit.data.dataset.dataset.Dataset.avg_actions_of_items" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the average number of items’ interaction records.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>numpy.float64: Average number of items’ interaction records.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deepcarskit.data.dataset.dataset.Dataset.avg_actions_of_user_context">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">avg_actions_of_user_context</span></span><a class="headerlink" href="#deepcarskit.data.dataset.dataset.Dataset.avg_actions_of_user_context" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deepcarskit.data.dataset.dataset.Dataset.avg_actions_of_users">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">avg_actions_of_users</span></span><a class="headerlink" href="#deepcarskit.data.dataset.dataset.Dataset.avg_actions_of_users" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the average number of users’ interaction records.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>numpy.float64: Average number of users’ interaction records.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepcarskit.data.dataset.dataset.Dataset.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#deepcarskit.data.dataset.dataset.Dataset.build" title="Permalink to this definition">¶</a></dt>
<dd><p>Processing dataset according to evaluation setting, including Group, Order and Split.
See <code class="xref py py-class docutils literal notranslate"><span class="pre">EvalSetting</span></code> for details.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>list: List of built <a class="reference internal" href="#deepcarskit.data.dataset.dataset.Dataset" title="deepcarskit.data.dataset.dataset.Dataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepcarskit.data.dataset.dataset.Dataset.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_inter_feat</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepcarskit.data.dataset.dataset.Dataset.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a new interaction feature, return a new <a class="reference internal" href="#deepcarskit.data.dataset.dataset.Dataset" title="deepcarskit.data.dataset.dataset.Dataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code></a> object,
whose interaction feature is updated with <code class="docutils literal notranslate"><span class="pre">new_inter_feat</span></code>, and all the other attributes the same.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>new_inter_feat (Interaction): The new interaction feature need to be updated.</p>
</dd>
<dt>Returns:</dt><dd><p><a class="reference internal" href="#deepcarskit.data.dataset.dataset.Dataset" title="deepcarskit.data.dataset.dataset.Dataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code></a>: the new <a class="reference internal" href="#deepcarskit.data.dataset.dataset.Dataset" title="deepcarskit.data.dataset.dataset.Dataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code></a> object, whose interaction feature has been updated.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepcarskit.data.dataset.dataset.Dataset.copy_field_property">
<span class="sig-name descname"><span class="pre">copy_field_property</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dest_field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_field</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepcarskit.data.dataset.dataset.Dataset.copy_field_property" title="Permalink to this definition">¶</a></dt>
<dd><p>Copy properties from <code class="docutils literal notranslate"><span class="pre">dest_field</span></code> towards <code class="docutils literal notranslate"><span class="pre">source_field</span></code>.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>dest_field (str): Destination field.
source_field (str): Source field.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepcarskit.data.dataset.dataset.Dataset.counter">
<span class="sig-name descname"><span class="pre">counter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepcarskit.data.dataset.dataset.Dataset.counter" title="Permalink to this definition">¶</a></dt>
<dd><p>Given <code class="docutils literal notranslate"><span class="pre">field</span></code>, if it is a token field in <code class="docutils literal notranslate"><span class="pre">inter_feat</span></code>,
return the counter containing the occurrences times in <code class="docutils literal notranslate"><span class="pre">inter_feat</span></code> of different tokens,
for other cases, raise ValueError.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>field (str): field name to get token counter.</p>
</dd>
<dt>Returns:</dt><dd><p>Counter: The counter of different tokens.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepcarskit.data.dataset.dataset.Dataset.field2feats">
<span class="sig-name descname"><span class="pre">field2feats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepcarskit.data.dataset.dataset.Dataset.field2feats" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepcarskit.data.dataset.dataset.Dataset.fields">
<span class="sig-name descname"><span class="pre">fields</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ftype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepcarskit.data.dataset.dataset.Dataset.fields" title="Permalink to this definition">¶</a></dt>
<dd><p>Given type and source of features, return all the field name of this type and source.
If <code class="docutils literal notranslate"><span class="pre">ftype</span> <span class="pre">==</span> <span class="pre">None</span></code>, the type of returned fields is not restricted.
If <code class="docutils literal notranslate"><span class="pre">source</span> <span class="pre">==</span> <span class="pre">None</span></code>, the source of returned fields is not restricted.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>ftype (FeatureType, optional): Type of features. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.
source (FeatureSource, optional): Source of features. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
<dt>Returns:</dt><dd><p>list: List of field names.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deepcarskit.data.dataset.dataset.Dataset.float_like_fields">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">float_like_fields</span></span><a class="headerlink" href="#deepcarskit.data.dataset.dataset.Dataset.float_like_fields" title="Permalink to this definition">¶</a></dt>
<dd><p>Get fields of type <code class="xref py py-obj docutils literal notranslate"><span class="pre">FLOAT</span></code> and
<code class="xref py py-obj docutils literal notranslate"><span class="pre">FLOAT_SEQ</span></code>.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>list: List of field names.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepcarskit.data.dataset.dataset.Dataset.get_item_feature">
<span class="sig-name descname"><span class="pre">get_item_feature</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#deepcarskit.data.dataset.dataset.Dataset.get_item_feature" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Returns:</dt><dd><p>Interaction: item features</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepcarskit.data.dataset.dataset.Dataset.get_preload_weight">
<span class="sig-name descname"><span class="pre">get_preload_weight</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepcarskit.data.dataset.dataset.Dataset.get_preload_weight" title="Permalink to this definition">¶</a></dt>
<dd><p>Get preloaded weight matrix, whose rows are sorted by token ids.</p>
<p><code class="docutils literal notranslate"><span class="pre">0</span></code> is used as padding.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>field (str): preloaded feature field name.</p>
</dd>
<dt>Returns:</dt><dd><p>numpy.ndarray: preloaded weight matrix. See <span class="xref std std-doc">../user_guide/config/data_settings</span> for details.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepcarskit.data.dataset.dataset.Dataset.get_user_feature">
<span class="sig-name descname"><span class="pre">get_user_feature</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#deepcarskit.data.dataset.dataset.Dataset.get_user_feature" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Returns:</dt><dd><p>Interaction: user features</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepcarskit.data.dataset.dataset.Dataset.history_item_matrix">
<span class="sig-name descname"><span class="pre">history_item_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value_field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepcarskit.data.dataset.dataset.Dataset.history_item_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Get dense matrix describe user’s history interaction records.</p>
<p><code class="docutils literal notranslate"><span class="pre">history_matrix[i]</span></code> represents user <code class="docutils literal notranslate"><span class="pre">i</span></code>’s history interacted item_id.</p>
<p><code class="docutils literal notranslate"><span class="pre">history_value[i]</span></code> represents user <code class="docutils literal notranslate"><span class="pre">i</span></code>’s history interaction records’ values,
<code class="docutils literal notranslate"><span class="pre">0</span></code> if <code class="docutils literal notranslate"><span class="pre">value_field</span> <span class="pre">=</span> <span class="pre">None</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">history_len[i]</span></code> represents number of user <code class="docutils literal notranslate"><span class="pre">i</span></code>’s history interaction records.</p>
<p><code class="docutils literal notranslate"><span class="pre">0</span></code> is used as padding.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>value_field (str, optional): Data of matrix, which should exist in <code class="docutils literal notranslate"><span class="pre">self.inter_feat</span></code>.</dt><dd><p>Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>tuple:</dt><dd><ul class="simple">
<li><p>History matrix (torch.Tensor): <code class="docutils literal notranslate"><span class="pre">history_matrix</span></code> described above.</p></li>
<li><p>History values matrix (torch.Tensor): <code class="docutils literal notranslate"><span class="pre">history_value</span></code> described above.</p></li>
<li><p>History length matrix (torch.Tensor): <code class="docutils literal notranslate"><span class="pre">history_len</span></code> described above.</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepcarskit.data.dataset.dataset.Dataset.history_user_matrix">
<span class="sig-name descname"><span class="pre">history_user_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value_field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepcarskit.data.dataset.dataset.Dataset.history_user_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Get dense matrix describe item’s history interaction records.</p>
<p><code class="docutils literal notranslate"><span class="pre">history_matrix[i]</span></code> represents item <code class="docutils literal notranslate"><span class="pre">i</span></code>’s history interacted item_id.</p>
<p><code class="docutils literal notranslate"><span class="pre">history_value[i]</span></code> represents item <code class="docutils literal notranslate"><span class="pre">i</span></code>’s history interaction records’ values,
<code class="docutils literal notranslate"><span class="pre">0</span></code> if <code class="docutils literal notranslate"><span class="pre">value_field</span> <span class="pre">=</span> <span class="pre">None</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">history_len[i]</span></code> represents number of item <code class="docutils literal notranslate"><span class="pre">i</span></code>’s history interaction records.</p>
<p><code class="docutils literal notranslate"><span class="pre">0</span></code> is used as padding.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>value_field (str, optional): Data of matrix, which should exist in <code class="docutils literal notranslate"><span class="pre">self.inter_feat</span></code>.</dt><dd><p>Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>tuple:</dt><dd><ul class="simple">
<li><p>History matrix (torch.Tensor): <code class="docutils literal notranslate"><span class="pre">history_matrix</span></code> described above.</p></li>
<li><p>History values matrix (torch.Tensor): <code class="docutils literal notranslate"><span class="pre">history_value</span></code> described above.</p></li>
<li><p>History length matrix (torch.Tensor): <code class="docutils literal notranslate"><span class="pre">history_len</span></code> described above.</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepcarskit.data.dataset.dataset.Dataset.id2token">
<span class="sig-name descname"><span class="pre">id2token</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ids</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepcarskit.data.dataset.dataset.Dataset.id2token" title="Permalink to this definition">¶</a></dt>
<dd><p>Map internal ids to external tokens.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>field (str): Field of internal ids.
ids (int, list, numpy.ndarray or torch.Tensor): Internal ids.</p>
</dd>
<dt>Returns:</dt><dd><p>str or numpy.ndarray: The external tokens of internal ids.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepcarskit.data.dataset.dataset.Dataset.inter_matrix">
<span class="sig-name descname"><span class="pre">inter_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">form</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'coo'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value_field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepcarskit.data.dataset.dataset.Dataset.inter_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Get sparse matrix that describe interactions between user_id and item_id.</p>
<p>Sparse matrix has shape (user_num, item_num).</p>
<p>For a row of &lt;src, tgt&gt;, <code class="docutils literal notranslate"><span class="pre">matrix[src,</span> <span class="pre">tgt]</span> <span class="pre">=</span> <span class="pre">1</span></code> if <code class="docutils literal notranslate"><span class="pre">value_field</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>,
else <code class="docutils literal notranslate"><span class="pre">matrix[src,</span> <span class="pre">tgt]</span> <span class="pre">=</span> <span class="pre">self.inter_feat[src,</span> <span class="pre">tgt]</span></code>.</p>
<dl>
<dt>Args:</dt><dd><p>form (str, optional): Sparse matrix format. Defaults to <code class="docutils literal notranslate"><span class="pre">coo</span></code>.
value_field (str, optional): Data of sparse matrix, which should exist in <code class="docutils literal notranslate"><span class="pre">df_feat</span></code>.</p>
<blockquote>
<div><p>Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</div></blockquote>
</dd>
<dt>Returns:</dt><dd><p>scipy.sparse: Sparse matrix in form <code class="docutils literal notranslate"><span class="pre">coo</span></code> or <code class="docutils literal notranslate"><span class="pre">csr</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deepcarskit.data.dataset.dataset.Dataset.inter_num">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">inter_num</span></span><a class="headerlink" href="#deepcarskit.data.dataset.dataset.Dataset.inter_num" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of interaction records.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>int: Number of interaction records.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deepcarskit.data.dataset.dataset.Dataset.item_counter">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">item_counter</span></span><a class="headerlink" href="#deepcarskit.data.dataset.dataset.Dataset.item_counter" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the counter containing the occurrences times in <code class="docutils literal notranslate"><span class="pre">inter_feat</span></code> of different items.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>Counter: The counter of different items.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deepcarskit.data.dataset.dataset.Dataset.item_num">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">item_num</span></span><a class="headerlink" href="#deepcarskit.data.dataset.dataset.Dataset.item_num" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of different tokens of <code class="docutils literal notranslate"><span class="pre">self.iid_field</span></code>.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>int: Number of different tokens of <code class="docutils literal notranslate"><span class="pre">self.iid_field</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepcarskit.data.dataset.dataset.Dataset.join">
<span class="sig-name descname"><span class="pre">join</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepcarskit.data.dataset.dataset.Dataset.join" title="Permalink to this definition">¶</a></dt>
<dd><p>Given interaction feature, join user/item feature into it.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>df (Interaction): Interaction feature to be joint.</p>
</dd>
<dt>Returns:</dt><dd><p>Interaction: Interaction feature after joining operation.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepcarskit.data.dataset.dataset.Dataset.leave_one_out">
<span class="sig-name descname"><span class="pre">leave_one_out</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">group_by</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">leave_one_mode</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepcarskit.data.dataset.dataset.Dataset.leave_one_out" title="Permalink to this definition">¶</a></dt>
<dd><p>Split interaction records by leave one out strategy.</p>
<dl>
<dt>Args:</dt><dd><p>group_by (str): Field name that interaction records should grouped by before splitting.
leave_one_mode (str): The way to leave one out. It can only take three values:</p>
<blockquote>
<div><p>‘valid_and_test’, ‘valid_only’ and ‘test_only’.</p>
</div></blockquote>
</dd>
<dt>Returns:</dt><dd><p>list: List of <a class="reference internal" href="#deepcarskit.data.dataset.dataset.Dataset" title="deepcarskit.data.dataset.dataset.Dataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code></a>, whose interaction features has been split.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deepcarskit.data.dataset.dataset.Dataset.non_seq_fields">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">non_seq_fields</span></span><a class="headerlink" href="#deepcarskit.data.dataset.dataset.Dataset.non_seq_fields" title="Permalink to this definition">¶</a></dt>
<dd><p>Get fields of type <code class="xref py py-obj docutils literal notranslate"><span class="pre">TOKEN</span></code> and
<code class="xref py py-obj docutils literal notranslate"><span class="pre">FLOAT</span></code>.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>list: List of field names.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepcarskit.data.dataset.dataset.Dataset.num">
<span class="sig-name descname"><span class="pre">num</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepcarskit.data.dataset.dataset.Dataset.num" title="Permalink to this definition">¶</a></dt>
<dd><p>Given <code class="docutils literal notranslate"><span class="pre">field</span></code>, for token-like fields, return the number of different tokens after remapping,
for float-like fields, return <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>field (str): field name to get token number.</p>
</dd>
<dt>Returns:</dt><dd><p>int: The number of different tokens (<code class="docutils literal notranslate"><span class="pre">1</span></code> if <code class="docutils literal notranslate"><span class="pre">field</span></code> is a float-like field).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepcarskit.data.dataset.dataset.Dataset.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#deepcarskit.data.dataset.dataset.Dataset.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Saving this <a class="reference internal" href="#deepcarskit.data.dataset.dataset.Dataset" title="deepcarskit.data.dataset.dataset.Dataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code></a> object to <code class="xref py py-attr docutils literal notranslate"><span class="pre">config['checkpoint_dir']</span></code>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deepcarskit.data.dataset.dataset.Dataset.seq_fields">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">seq_fields</span></span><a class="headerlink" href="#deepcarskit.data.dataset.dataset.Dataset.seq_fields" title="Permalink to this definition">¶</a></dt>
<dd><p>Get fields of type <code class="xref py py-obj docutils literal notranslate"><span class="pre">TOKEN_SEQ</span></code> and
<code class="xref py py-obj docutils literal notranslate"><span class="pre">FLOAT_SEQ</span></code>.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>list: List of field names.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepcarskit.data.dataset.dataset.Dataset.set_field_property">
<span class="sig-name descname"><span class="pre">set_field_property</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field_source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field_seqlen</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepcarskit.data.dataset.dataset.Dataset.set_field_property" title="Permalink to this definition">¶</a></dt>
<dd><p>Set a new field’s properties.</p>
<dl>
<dt>Args:</dt><dd><p>field (str): Name of the new field.
field_type (FeatureType): Type of the new field.
field_source (FeatureSource): Source of the new field.
field_seqlen (int): max length of the sequence in <code class="docutils literal notranslate"><span class="pre">field</span></code>.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">1</span></code> if <code class="docutils literal notranslate"><span class="pre">field</span></code>’s type is not sequence-like.</p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepcarskit.data.dataset.dataset.Dataset.shuffle">
<span class="sig-name descname"><span class="pre">shuffle</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#deepcarskit.data.dataset.dataset.Dataset.shuffle" title="Permalink to this definition">¶</a></dt>
<dd><p>Shuffle the interaction records inplace.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepcarskit.data.dataset.dataset.Dataset.sort">
<span class="sig-name descname"><span class="pre">sort</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">by</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ascending</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepcarskit.data.dataset.dataset.Dataset.sort" title="Permalink to this definition">¶</a></dt>
<dd><p>Sort the interaction records inplace.</p>
<dl>
<dt>Args:</dt><dd><p>by (str or list of str): Field that as the key in the sorting process.
ascending (bool or list of bool, optional): Results are ascending if <code class="docutils literal notranslate"><span class="pre">True</span></code>, otherwise descending.</p>
<blockquote>
<div><p>Defaults to <code class="docutils literal notranslate"><span class="pre">True</span></code></p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deepcarskit.data.dataset.dataset.Dataset.sparsity">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sparsity</span></span><a class="headerlink" href="#deepcarskit.data.dataset.dataset.Dataset.sparsity" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the sparsity of this dataset.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>float: Sparsity of this dataset.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepcarskit.data.dataset.dataset.Dataset.split_by_folds">
<span class="sig-name descname"><span class="pre">split_by_folds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">folds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepcarskit.data.dataset.dataset.Dataset.split_by_folds" title="Permalink to this definition">¶</a></dt>
<dd><p>Split interaction records by ratios.</p>
<dl>
<dt>Args:</dt><dd><p>folds (int): Number of folds
group_by (str, optional): Field name that interaction records should grouped by before splitting.</p>
<blockquote>
<div><p>Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</div></blockquote>
</dd>
<dt>Returns:</dt><dd><p>list: List of <a class="reference internal" href="#deepcarskit.data.dataset.dataset.Dataset" title="deepcarskit.data.dataset.dataset.Dataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code></a>, whose interaction features has been split.</p>
</dd>
<dt>Note:</dt><dd><p>Other than the first one, each part is rounded down.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepcarskit.data.dataset.dataset.Dataset.split_by_ratio">
<span class="sig-name descname"><span class="pre">split_by_ratio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ratios</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepcarskit.data.dataset.dataset.Dataset.split_by_ratio" title="Permalink to this definition">¶</a></dt>
<dd><p>Split interaction records by ratios.</p>
<dl>
<dt>Args:</dt><dd><p>ratios (list): List of split ratios. No need to be normalized.
group_by (str, optional): Field name that interaction records should grouped by before splitting.</p>
<blockquote>
<div><p>Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</div></blockquote>
</dd>
<dt>Returns:</dt><dd><p>list: List of <a class="reference internal" href="#deepcarskit.data.dataset.dataset.Dataset" title="deepcarskit.data.dataset.dataset.Dataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code></a>, whose interaction features has been split.</p>
</dd>
<dt>Note:</dt><dd><p>Other than the first one, each part is rounded down.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepcarskit.data.dataset.dataset.Dataset.token2id">
<span class="sig-name descname"><span class="pre">token2id</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokens</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepcarskit.data.dataset.dataset.Dataset.token2id" title="Permalink to this definition">¶</a></dt>
<dd><p>Map external tokens to internal ids.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>field (str): Field of external tokens.
tokens (str, list or numpy.ndarray): External tokens.</p>
</dd>
<dt>Returns:</dt><dd><p>int or numpy.ndarray: The internal ids of external tokens.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deepcarskit.data.dataset.dataset.Dataset.token_like_fields">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">token_like_fields</span></span><a class="headerlink" href="#deepcarskit.data.dataset.dataset.Dataset.token_like_fields" title="Permalink to this definition">¶</a></dt>
<dd><p>Get fields of type <code class="xref py py-obj docutils literal notranslate"><span class="pre">TOKEN</span></code> and
<code class="xref py py-obj docutils literal notranslate"><span class="pre">TOKEN_SEQ</span></code>.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>list: List of field names.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepcarskit.data.dataset.dataset.Dataset.unique">
<span class="sig-name descname"><span class="pre">unique</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepcarskit.data.dataset.dataset.Dataset.unique" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deepcarskit.data.dataset.dataset.Dataset.user_context_num">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">user_context_num</span></span><a class="headerlink" href="#deepcarskit.data.dataset.dataset.Dataset.user_context_num" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deepcarskit.data.dataset.dataset.Dataset.user_counter">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">user_counter</span></span><a class="headerlink" href="#deepcarskit.data.dataset.dataset.Dataset.user_counter" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the counter containing the occurrences times in <code class="docutils literal notranslate"><span class="pre">inter_feat</span></code> of different users.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>Counter: The counter of different users.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deepcarskit.data.dataset.dataset.Dataset.user_num">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">user_num</span></span><a class="headerlink" href="#deepcarskit.data.dataset.dataset.Dataset.user_num" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of different tokens of <code class="docutils literal notranslate"><span class="pre">self.uid_field</span></code>.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>int: Number of different tokens of <code class="docutils literal notranslate"><span class="pre">self.uid_field</span></code>.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="module-deepcarskit.data.dataset">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-deepcarskit.data.dataset" title="Permalink to this headline">¶</a></h2>
</section>
</section>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2022, Yong Zheng

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>